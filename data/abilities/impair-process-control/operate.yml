- id: 5a073c32-e022-3724-85ad-7192464287b8
  name: DNP3 (TCP) - Operate
  description: Operate DNP3 control points using either Direct Operate or Select Before Operate mode.
  tactic: impair-process-control
  technique_id: T0855
  technique_name: Unauthorized Command Message
  executors:
  - platform: linux
    name: sh
    command: >
      ./dnp3-actions tcp #{dnp3.server.ip} #{dnp3.local.link} #{dnp3.remote.link}
      operate #{dnp3.operate.mode} --indices #{dnp3.operate.indices}
      --op-type #{dnp3.operate.type} --tcc #{dnp3.operate.tcc}
    payloads:
    - dnp3-actions
    timeout: 60
  - platform: windows
    name: psh
    command: >
      .\dnp3-actions.exe tcp #{dnp3.server.ip} #{dnp3.local.link} #{dnp3.remote.link}
      operate #{dnp3.operate.mode} --indices #{dnp3.operate.indices} 
      --op-type #{dnp3.operate.type} --tcc #{dnp3.operate.tcc}
    payloads:
    - dnp3-actions.exe
    timeout: 60
  - platform: windows
    name: cmd
    command: >
      .\dnp3-actions.exe tcp #{dnp3.server.ip} #{dnp3.local.link} #{dnp3.remote.link}
      operate #{dnp3.operate.mode} --indices #{dnp3.operate.indices}
      --op-type #{dnp3.operate.type} --tcc #{dnp3.operate.tcc}
    payloads:
    - dnp3-actions.exe
    timeout: 60
  - platform: darwin
    name: sh
    command: >
      ./dnp3-actions_darwin tcp #{dnp3.server.ip} #{dnp3.local.link} #{dnp3.remote.link}
      operate #{dnp3.operate.mode} --indices #{dnp3.operate.indices}
      --op-type #{dnp3.operate.type} --tcc #{dnp3.operate.tcc}
    payloads:
    - dnp3-actions_darwin
    timeout: 60
  repeatable: false
  plugin: dnp3

- id: 1d2e92a6-4baa-471f-b878-74b8c21528fb
  name: DNP3 (Serial) - Operate
  description: Operate DNP3 control points using either Direct Operate or Select Before Operate mode.
  tactic: impair-process-control
  technique_id: T0855
  technique_name: Unauthorized Command Message
  executors:
  - platform: linux
    name: sh
    command: >
      ./dnp3-actions serial #{dnp3.server.serial_device} #{dnp3.local.link} #{dnp3.remote.link}
      operate #{dnp3.operate.mode} --indices #{dnp3.operate.indices}
      --op-type #{dnp3.operate.type} --tcc #{dnp3.operate.tcc}
    payloads:
    - dnp3-actions
    timeout: 60
  - platform: windows
    name: psh
    command: >
      .\dnp3-actions.exe serial #{dnp3.server.serial_device} #{dnp3.local.link} #{dnp3.remote.link}
      operate #{dnp3.operate.mode} --indices #{dnp3.operate.indices} 
      --op-type #{dnp3.operate.type} --tcc #{dnp3.operate.tcc}
    payloads:
    - dnp3-actions.exe
    timeout: 60
  - platform: windows
    name: cmd
    command: >
      .\dnp3-actions.exe serial #{dnp3.server.serial_device} #{dnp3.local.link} #{dnp3.remote.link}
      operate #{dnp3.operate.mode} --indices #{dnp3.operate.indices}
      --op-type #{dnp3.operate.type} --tcc #{dnp3.operate.tcc}
    payloads:
    - dnp3-actions.exe
    timeout: 60
  - platform: darwin
    name: sh
    command: >
      ./dnp3-actions_darwin serial #{dnp3.server.serial_device} #{dnp3.local.link} #{dnp3.remote.link}
      operate #{dnp3.operate.mode} --indices #{dnp3.operate.indices}
      --op-type #{dnp3.operate.type} --tcc #{dnp3.operate.tcc}
    payloads:
    - dnp3-actions_darwin
    timeout: 60
  repeatable: false
  plugin: dnp3
